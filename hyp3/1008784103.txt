photon mapping is particularly adept at handling this effect because the algorithm reflects photons from one surface to another based on that surface 's bidirectional reflectance distribution function ( brdf ) , and thus light from one object striking another is a natural result of the method this was the original way jensen implemented it ; however , the method becomes slow for highly scattering materials , and bidirectional surface scattering reflectance distribution functions ( bssrdfs ) are more efficient in these situations once the photon map is constructed ( or during construction ) , it is typically arranged in a manner that is optimal for the k-nearest neighbor algorithm , as photon look-up time depends on the spatial distribution of the photons in this step of the algorithm , the photon map created in the first pass is used to estimate the radiance of every pixel of the output image at this point , the rendering equation is used to calculate the surface radiance leaving the point of intersection in the direction of the ray that struck it for each photon , divide the amount of flux ( real photons ) that the photon represents by the area of s and multiply by the brdf applied to that photon instead of simply sending out photons in random directions , they are sent in the direction of a known object that is a desired photon manipulator to either focus or diffuse the light there are many other refinements that can be made to the algorithm : for example , choosing the number of photons to send , and where and in what pattern to send them it would seem that emitting more photons in a specific direction would cause a higher density of photons to be stored in the photon map around the position where the photons hit , and thus measuring this density would give an inaccurate value for irradiance during the photon mapping process , when a photon strikes a surface , in addition to the usual operations performed , a shadow photon is emitted in the same direction the original photon came from that goes all the way through the object then during the direct illumination calculation , instead of sending out a ray from the surface to the light that tests collisions with objects , the photon map is queried for shadow photons 